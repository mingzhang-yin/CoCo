python main.py --lr 0.003 --lmbd 10000 --anneal 100
train environment:  43
['/coyote', '/raccoon']
class_indices:  [(0, '/coyote'), (1, '/raccoon')]
train environment:  46
['/coyote', '/raccoon']
class_indices:  [(0, '/coyote'), (1, '/raccoon')]
['/coyote', '/raccoon']

working with 2 training environments: 
env['images']:  858
env['labels']:  858
class distribution:  582 coyotes and 276 raccoons. baseline accuracy 0.68 (always coyote).
env['images']:  753
env['labels']:  753
class distribution:  512 coyotes and 241 raccoons. baseline accuracy 0.68 (always coyote).
x_test:  522
y_test:  522
test class distribution:  144 coyotes and 378 raccoons. baseline accuracy 0.28 (always coyote).
Using GPU - True

========================================IRM========================================
{'n_restarts': 1, 'steps': 2001, 'n_classes': 2, 'fc_only': True, 'model_path': './models/', 'transform': {'train': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
), 'test': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'loader_tr_args': {'batch_size': 100, 'num_workers': 1}, 'loader_te_args': {'batch_size': 100, 'num_workers': 1}, 'loader_sample_args': {'batch_size': 100, 'num_workers': 1}, 'optimizer_args': {'l2_regularizer_weight': 0.001}}
step            loss            train nll       train acc       train penalty   test nll        test acc        test prec       test rec     
0               0.69641         0.69640         0.47178         1.28010e-05     0.76303         0.26364         0.00000         0.00000      
10              0.59844         0.59609         0.67465         0.00235         0.82731         0.28727         0.00000         0.00000      
20              0.53963         0.52430         0.67721         0.01533         0.72720         0.29318         0.00000         0.00000      
30              0.49753         0.47576         0.82528         0.02176         0.70710         0.32545         0.84091         0.09788      
40              0.46089         0.43269         0.86681         0.02820         0.65512         0.48561         0.80829         0.41270      
50              0.42404         0.39392         0.87136         0.03012         0.75109         0.36318         0.80882         0.14550      
60              0.39564         0.36599         0.87687         0.02966         0.70789         0.44818         0.80000         0.32804      
70              0.36632         0.33639         0.88931         0.02993         0.82508         0.36227         0.80000         0.15873      
80              0.34204         0.31417         0.90014         0.02788         0.88392         0.35727         0.83871         0.13757      
90              0.31996         0.29332         0.90453         0.02664         0.92182         0.35803         0.83824         0.15079      
100             237.20187       0.27692         0.90598         236.92496       0.74795         0.50182         0.79365         0.39683      
110             55.46720        0.35611         0.84747         55.11109        0.40449         0.88333         0.84375         1.00000      
120             18.34493        0.34985         0.84365         17.99508        0.38914         0.87576         0.84187         1.00000      
130             19.22894        0.38149         0.82049         18.84745        0.41911         0.84712         0.83628         1.00000      
140             8.13039         0.35566         0.83376         7.77473         0.40462         0.86394         0.84187         1.00000      
150             7.06180         0.34687         0.83825         6.71493         0.39221         0.86985         0.84187         1.00000      
160             3.74093         0.35110         0.83392         3.38984         0.39633         0.86394         0.84187         1.00000      
170             3.63341         0.34149         0.84144         3.29193         0.39765         0.85636         0.84152         0.99735      
180             0.95442         0.34344         0.83864         0.61098         0.40623         0.85636         0.84152         0.99735      
190             1.93649         0.33502         0.84396         1.60147         0.40389         0.86227         0.84152         0.99735      
200             0.39880         0.34256         0.83356         0.05623         0.40791         0.86227         0.84152         0.99735      
210             0.85326         0.33584         0.84307         0.51742         0.41133         0.85636         0.84152         0.99735      
220             0.75606         0.33481         0.83764         0.42124         0.39954         0.86227         0.84152         0.99735      
230             0.54438         0.34335         0.83220         0.20103         0.38636         0.87409         0.84152         0.99735      
240             0.37473         0.33723         0.83733         0.03750         0.41035         0.85803         0.84187         1.00000      
250             1.39698         0.32944         0.84349         1.06754         0.40188         0.86227         0.84152         0.99735      
260             0.42541         0.33986         0.83902         0.08555         0.39440         0.86818         0.84152         0.99735      
270             0.71629         0.33810         0.83891         0.37818         0.38418         0.87409         0.84152         0.99735      
280             0.38390         0.33745         0.84015         0.04644         0.39775         0.86227         0.84152         0.99735      
290             0.47808         0.33513         0.84055         0.14295         0.39473         0.86985         0.84187         1.00000      
300             0.64107         0.33831         0.84072         0.30277         0.39841         0.86394         0.84187         1.00000      
310             0.38476         0.33912         0.83871         0.04564         0.40728         0.86227         0.84152         0.99735      
320             0.42226         0.33855         0.83562         0.08372         0.41142         0.85636         0.84152         0.99735      
330             0.54232         0.34157         0.83683         0.20075         0.43751         0.83439         0.84187         1.00000      
340             0.48188         0.34134         0.83691         0.14054         0.37791         0.88000         0.84152         0.99735      
350             0.36347         0.33881         0.84071         0.02466         0.39686         0.86394         0.84187         1.00000      
360             0.44663         0.33966         0.83671         0.10697         0.39558         0.86985         0.84187         1.00000      
370             0.44205         0.34073         0.83481         0.10131         0.41087         0.85636         0.84152         0.99735      
380             0.98197         0.34705         0.83217         0.63492         0.41192         0.85636         0.84152         0.99735      
390             1.03796         0.34824         0.82672         0.68971         0.42519         0.84621         0.84187         1.00000      
400             0.45282         0.33668         0.84007         0.11614         0.42092         0.85212         0.84187         1.00000      
410             0.53197         0.33977         0.83770         0.19220         0.39413         0.86985         0.84187         1.00000      
420             1.05200         0.33586         0.83719         0.71614         0.39180         0.86985         0.84187         1.00000      
430             0.45939         0.34220         0.83229         0.11719         0.41406         0.85636         0.84152         0.99735      
440             0.52267         0.34339         0.83484         0.17928         0.41547         0.85803         0.84187         1.00000      
450             0.58310         0.34108         0.83470         0.24202         0.40134         0.86394         0.84187         1.00000      
460             0.63576         0.34486         0.82898         0.29090         0.42073         0.85212         0.84187         1.00000      
470             0.46505         0.33734         0.83847         0.12771         0.43095         0.84621         0.84187         1.00000      
480             0.51817         0.33644         0.83754         0.18172         0.40481         0.85803         0.84187         1.00000      
490             0.54245         0.33405         0.83978         0.20841         0.39041         0.86985         0.84187         1.00000      
500             0.52186         0.33605         0.83697         0.18581         0.39589         0.86985         0.84187         1.00000      
510             0.87048         0.34136         0.83668         0.52912         0.41343         0.85803         0.84187         1.00000      
520             0.39368         0.33610         0.84062         0.05758         0.40448         0.86394         0.84187         1.00000      
530             0.44049         0.33633         0.83336         0.10416         0.41297         0.85803         0.84187         1.00000      
540             0.48272         0.33742         0.83629         0.14530         0.39505         0.86985         0.84187         1.00000      
550             0.35985         0.34099         0.83667         0.01886         0.40127         0.86394         0.84187         1.00000      
560             0.61747         0.33486         0.83574         0.28261         0.40810         0.86394         0.84187         1.00000      
570             0.36247         0.34051         0.83438         0.02196         0.42251         0.85212         0.84187         1.00000      
580             0.34520         0.34178         0.83217         0.00343         0.40499         0.86394         0.84187         1.00000      
590             0.34176         0.33936         0.83511         0.00240         0.40997         0.86394         0.84187         1.00000      
600             0.86944         0.34400         0.83270         0.52544         0.42269         0.84621         0.84187         1.00000      
610             0.36825         0.34051         0.83435         0.02775         0.40885         0.85803         0.84187         1.00000      
620             0.34989         0.33966         0.83626         0.01023         0.39189         0.86985         0.84187         1.00000      
630             0.45420         0.33665         0.83670         0.11755         0.40055         0.86394         0.84187         1.00000      
640             0.56060         0.34068         0.83269         0.21992         0.41617         0.85636         0.84152         0.99735      
650             0.74847         0.34590         0.83077         0.40257         0.39400         0.86985         0.84187         1.00000      
660             0.34717         0.33990         0.83636         0.00727         0.40883         0.86394         0.84187         1.00000      
670             0.44262         0.33842         0.83507         0.10421         0.41693         0.85803         0.84187         1.00000      
680             1.13467         0.33519         0.83943         0.79948         0.41796         0.85636         0.84152         0.99735      
690             0.41951         0.33917         0.83507         0.08034         0.39094         0.87409         0.84152         0.99735      
700             0.35079         0.33786         0.83404         0.01293         0.41731         0.85803         0.84187         1.00000      
710             0.37768         0.34003         0.83632         0.03765         0.38853         0.87576         0.84187         1.00000      
720             0.45845         0.33954         0.83253         0.11891         0.40102         0.86394         0.84187         1.00000      
730             0.48929         0.34166         0.83460         0.14762         0.41781         0.84879         0.83814         1.00000      
740             0.64331         0.33697         0.83643         0.30633         0.41184         0.85803         0.84187         1.00000      
750             0.39963         0.33932         0.83642         0.06031         0.39755         0.86818         0.84000         1.00000      
760             0.35389         0.34139         0.83292         0.01251         0.41878         0.85803         0.84187         1.00000      
770             0.49949         0.34353         0.83295         0.15596         0.40774         0.86227         0.84000         1.00000      
780             0.42172         0.34480         0.83031         0.07692         0.39007         0.87409         0.84000         1.00000      
790             0.38459         0.34319         0.82935         0.04140         0.42824         0.84621         0.84187         1.00000      
800             0.40328         0.33941         0.83469         0.06387         0.38966         0.87242         0.83814         1.00000      
810             1.02774         0.33305         0.83508         0.69469         0.38454         0.88167         0.84187         1.00000      
820             0.58417         0.33713         0.83304         0.24704         0.40114         0.86985         0.84187         1.00000      
830             0.65028         0.33574         0.83847         0.31455         0.40010         0.86985         0.84187         1.00000      
840             0.51301         0.34192         0.83187         0.17110         0.44954         0.83439         0.84187         1.00000      
850             0.35443         0.33788         0.83656         0.01655         0.40180         0.86985         0.84187         1.00000      
860             0.45845         0.33541         0.83802         0.12304         0.40536         0.86985         0.84187         1.00000      
870             0.52035         0.33644         0.83545         0.18391         0.39351         0.87576         0.84187         1.00000      
880             0.38736         0.33822         0.83808         0.04914         0.41355         0.85803         0.84187         1.00000      
890             0.37514         0.34059         0.83275         0.03455         0.40457         0.86985         0.84187         1.00000      
900             0.85440         0.33623         0.83447         0.51816         0.42446         0.85212         0.84187         1.00000      
910             0.72250         0.33607         0.83781         0.38643         0.44885         0.83273         0.84000         1.00000      
920             0.36308         0.33692         0.83679         0.02616         0.42469         0.85212         0.84187         1.00000      
930             0.43522         0.34021         0.83350         0.09502         0.40439         0.86227         0.84000         1.00000      
940             0.49601         0.34196         0.83213         0.15405         0.44306         0.83697         0.83814         1.00000      
950             0.42397         0.33954         0.83261         0.08443         0.40608         0.86985         0.84187         1.00000      
960             0.55433         0.34073         0.83387         0.21360         0.42193         0.85470         0.83814         1.00000      
970             0.67503         0.34277         0.83210         0.33226         0.40929         0.85470         0.83814         1.00000      
980             0.52557         0.33815         0.83484         0.18742         0.44659         0.83273         0.84000         1.00000      
990             0.52080         0.33998         0.83412         0.18083         0.41657         0.85470         0.83814         1.00000      
1000            0.45940         0.33833         0.83529         0.12107         0.41217         0.86061         0.83814         1.00000      
1010            0.34481         0.33986         0.83030         0.00495         0.42828         0.84879         0.83814         1.00000      
1020            0.58652         0.33398         0.83649         0.25253         0.40528         0.86818         0.84000         1.00000      
1030            0.51399         0.34157         0.83282         0.17242         0.41545         0.86061         0.83814         1.00000      
1040            0.51504         0.33935         0.83271         0.17570         0.41684         0.86227         0.84000         1.00000      
1050            0.38850         0.34049         0.82932         0.04802         0.41177         0.86061         0.83814         1.00000      
1060            0.36018         0.34188         0.83253         0.01830         0.39642         0.86652         0.83814         1.00000      
1070            0.34375         0.33945         0.83363         0.00430         0.42657         0.84879         0.83814         1.00000      
1080            1.06926         0.33721         0.83409         0.73205         0.41409         0.86061         0.83814         1.00000      
1090            0.39971         0.33641         0.83786         0.06330         0.42152         0.84879         0.83814         1.00000      
1100            0.43250         0.33684         0.83460         0.09565         0.42365         0.85470         0.83814         1.00000      
1110            0.34525         0.34245         0.82981         0.00280         0.39789         0.87242         0.83814         1.00000      
1120            0.46322         0.33878         0.83269         0.12444         0.40205         0.86485         0.83628         1.00000      
1130            0.54933         0.34231         0.82970         0.20702         0.40831         0.86652         0.83814         1.00000      
1140            0.34481         0.33962         0.83315         0.00519         0.40460         0.86485         0.83628         1.00000      
1150            0.63493         0.33748         0.83272         0.29745         0.41702         0.85894         0.83628         1.00000      
1160            0.67022         0.34526         0.82609         0.32496         0.43031         0.84879         0.83814         1.00000      
1170            0.60304         0.34497         0.83143         0.25807         0.41367         0.85894         0.83628         1.00000      
1180            0.39071         0.34004         0.83089         0.05066         0.41855         0.85303         0.83628         1.00000      
1190            0.51334         0.33912         0.83150         0.17422         0.41131         0.86061         0.83814         1.00000      
1200            0.57178         0.33867         0.83291         0.23312         0.43520         0.84121         0.83628         1.00000      
1210            0.35989         0.34181         0.83007         0.01809         0.42451         0.85470         0.83814         1.00000      
1220            0.55403         0.34030         0.82819         0.21373         0.40559         0.86652         0.83814         1.00000      
1230            0.60041         0.34050         0.82900         0.25991         0.41921         0.86061         0.83814         1.00000      
1240            1.22029         0.34904         0.82622         0.87125         0.41358         0.85894         0.83628         1.00000      
1250            0.98058         0.34711         0.82946         0.63347         0.41416         0.85894         0.83628         1.00000      
1260            0.78610         0.33525         0.83570         0.45085         0.41048         0.85894         0.83628         1.00000      
1270            0.38713         0.33976         0.82967         0.04737         0.41209         0.85894         0.83628         1.00000      
1280            0.95287         0.33734         0.83065         0.61553         0.40570         0.87076         0.83628         1.00000      
1290            0.37186         0.34347         0.82968         0.02839         0.42178         0.85303         0.83628         1.00000      
1300            0.53455         0.34439         0.83057         0.19016         0.42482         0.85303         0.83628         1.00000      
1310            1.00021         0.34663         0.82657         0.65359         0.39606         0.87076         0.83628         1.00000      
1320            0.61321         0.34103         0.83029         0.27217         0.41829         0.85894         0.83628         1.00000      
1330            0.42935         0.34290         0.82741         0.08645         0.41347         0.86485         0.83628         1.00000      
1340            0.50005         0.34496         0.82653         0.15509         0.39817         0.87076         0.83628         1.00000      
1350            0.80989         0.33539         0.83493         0.47450         0.43380         0.84879         0.83814         1.00000      
1360            0.39118         0.34105         0.83107         0.05014         0.42484         0.85303         0.83628         1.00000      
1370            0.41286         0.34235         0.82758         0.07052         0.42056         0.85894         0.83628         1.00000      
1380            0.38205         0.34159         0.82871         0.04046         0.45088         0.83530         0.83628         1.00000      
1390            0.34535         0.34094         0.82913         0.00441         0.41137         0.86485         0.83628         1.00000      
1400            0.36443         0.34109         0.83017         0.02334         0.40183         0.87076         0.83628         1.00000      
1410            1.09944         0.34163         0.83398         0.75782         0.42800         0.85303         0.83628         1.00000      
1420            0.83729         0.33561         0.83208         0.50168         0.44358         0.83530         0.83628         1.00000      
1430            0.45715         0.34056         0.83186         0.11659         0.42259         0.85303         0.83628         1.00000      
1440            0.35579         0.34110         0.82845         0.01469         0.41107         0.85894         0.83628         1.00000      
1450            0.60918         0.33479         0.83636         0.27439         0.41596         0.85894         0.83628         1.00000      
1460            0.43604         0.33849         0.83272         0.09755         0.41769         0.86652         0.83814         1.00000      
1470            0.39474         0.34346         0.82747         0.05128         0.40888         0.87409         0.84000         1.00000      
1480            0.38642         0.34427         0.82534         0.04215         0.42533         0.85303         0.83628         1.00000      
1490            0.35884         0.34221         0.82957         0.01663         0.41699         0.85894         0.83628         1.00000      
1500            0.71937         0.34705         0.82402         0.37232         0.44142         0.84121         0.83628         1.00000      
1510            0.78519         0.34598         0.82673         0.43921         0.40153         0.87076         0.83628         1.00000      
1520            0.37354         0.34145         0.82890         0.03208         0.41440         0.86485         0.83628         1.00000      
1530            0.47112         0.34191         0.83150         0.12921         0.45156         0.83530         0.83628         1.00000      
1540            0.42244         0.34336         0.82907         0.07907         0.41881         0.85303         0.83628         1.00000      
1550            0.49913         0.34512         0.82869         0.15402         0.43804         0.84121         0.83628         1.00000      
1560            0.40946         0.34549         0.82606         0.06398         0.42570         0.85303         0.83628         1.00000      
1570            0.68846         0.34029         0.82970         0.34816         0.42865         0.84712         0.83628         1.00000      
1580            0.37931         0.33899         0.83223         0.04033         0.40177         0.87833         0.83814         1.00000      
1590            0.39797         0.34104         0.82859         0.05693         0.40880         0.85894         0.83628         1.00000      
1600            0.56800         0.34260         0.82766         0.22540         0.39867         0.87076         0.83628         1.00000      
1610            0.35480         0.34121         0.82976         0.01359         0.43424         0.84712         0.83628         1.00000      
1620            0.36837         0.34118         0.82906         0.02719         0.42769         0.85303         0.83628         1.00000      
1630            0.37727         0.34529         0.82502         0.03197         0.42153         0.85894         0.83628         1.00000      
1640            0.44883         0.34370         0.82756         0.10512         0.42622         0.85303         0.83628         1.00000      
1650            0.66526         0.33716         0.83388         0.32810         0.42294         0.85303         0.83628         1.00000      
1660            0.50904         0.34128         0.82917         0.16775         0.43072         0.84712         0.83628         1.00000      
1670            0.37233         0.34270         0.82643         0.02963         0.41573         0.86485         0.83628         1.00000      
1680            0.35621         0.34227         0.82688         0.01394         0.41165         0.86485         0.83628         1.00000      
1690            0.40526         0.34619         0.82610         0.05908         0.43783         0.84121         0.83628         1.00000      
1700            0.44851         0.33991         0.82972         0.10860         0.40987         0.86485         0.83628         1.00000      
1710            0.63286         0.34360         0.82734         0.28926         0.42979         0.85303         0.83628         1.00000      
1720            0.64482         0.34740         0.82501         0.29742         0.41055         0.86485         0.83628         1.00000      
1730            0.44584         0.34156         0.82576         0.10428         0.41734         0.85894         0.83628         1.00000      
1740            0.62231         0.34758         0.82123         0.27473         0.43651         0.84712         0.83628         1.00000      
1750            0.48504         0.34288         0.82622         0.14216         0.43619         0.84712         0.83628         1.00000      
1760            0.44061         0.34411         0.82969         0.09649         0.43346         0.84712         0.83628         1.00000      
1770            0.72440         0.33961         0.82585         0.38479         0.42420         0.86485         0.83628         1.00000      
1780            0.38110         0.34486         0.82745         0.03624         0.43088         0.85303         0.83628         1.00000      
1790            0.45539         0.34348         0.82573         0.11192         0.44535         0.83530         0.83628         1.00000      
1800            0.51745         0.34350         0.82496         0.17394         0.41105         0.87076         0.83628         1.00000      
1810            0.34770         0.34294         0.82459         0.00476         0.42732         0.85894         0.83628         1.00000      
1820            0.63465         0.34148         0.82664         0.29317         0.40191         0.87667         0.83628         1.00000      
1830            0.34362         0.34279         0.82322         0.00084         0.41990         0.86485         0.83628         1.00000      
1840            0.55604         0.34354         0.82750         0.21250         0.41241         0.87076         0.83628         1.00000      
1850            1.01661         0.33623         0.83176         0.68038         0.40741         0.87667         0.83628         1.00000      
1860            0.38234         0.34193         0.82795         0.04041         0.42758         0.85303         0.83628         1.00000      
1870            0.58849         0.33814         0.82725         0.25034         0.41617         0.86485         0.83628         1.00000      
1880            1.33200         0.33881         0.82802         0.99319         0.42440         0.85894         0.83628         1.00000      
1890            0.45132         0.34531         0.82398         0.10601         0.42496         0.85894         0.83628         1.00000      
1900            0.47741         0.34463         0.82485         0.13278         0.42071         0.86485         0.83628         1.00000      
1910            0.46328         0.34506         0.82290         0.11822         0.42509         0.85894         0.83628         1.00000      
1920            0.54481         0.34480         0.82368         0.20001         0.42445         0.85894         0.83628         1.00000      
1930            0.40367         0.33794         0.83004         0.06573         0.42640         0.85303         0.83628         1.00000      
1940            0.42325         0.34038         0.83088         0.08287         0.41872         0.85894         0.83628         1.00000      
1950            0.54445         0.33690         0.83192         0.20754         0.41914         0.85894         0.83628         1.00000      
1960            0.35774         0.34129         0.82582         0.01645         0.42804         0.85303         0.83628         1.00000      
1970            1.64495         0.34542         0.82607         1.29952         0.41616         0.86485         0.83628         1.00000      
1980            0.70032         0.34674         0.82263         0.35359         0.42510         0.85894         0.83628         1.00000      
1990            0.42945         0.34095         0.82979         0.08849         0.41539         0.86485         0.83628         1.00000      
2000            0.58645         0.33877         0.82824         0.24767         0.42120         0.85894         0.83628         1.00000      
Final train acc (mean/std):
0.828 0.0
Final test acc (mean/std):
0.859 0.0
Final test precision:
0.8363
Final test recall:
1.0
confusion matrix:
[[ 70  74]
 [  0 378]]
tn = 70, fp = 74, fn = 0, tp = 378
